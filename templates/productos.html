{% extends "base.html" %}

{% block content %}
<section class="productos-container">
    {% for grupo in productos_por_marca %}
        <h2 class="marca-titulo">{{ grupo.marca }}</h2>
        <div class="marca-productos">
            {% for producto in grupo.productos %}
                <div class="card">
                    <img src="{{ url_for('static', filename='img/' ~ producto.imagen) }}" alt="{{ producto.nombre }}">
                    <h3>{{ producto.nombre }}</h3>
                    <p>{{ producto.descripcion }}</p>
                    <p class="precio">$ {{ producto.precio }}</p>
                    <button class="btn-agregar" 
                            data-id="{{ producto.id }}" >
                        AÃ±adir al carrito
                    
                </div>
            {% endfor %}
        </div>
    {% endfor %}
</section>


<script>
    document.addEventListener("DOMContentLoaded", () => {
        const botones = document.querySelectorAll(".btn-agregar");
    
        botones.forEach(boton => {
            boton.addEventListener("click", async () => {
                const id = boton.dataset.id;
    
                try {
                    const respuesta = await fetch(`/agregar_carrito/${id}`);
                    if (respuesta.ok) {
                        // Muestra un aviso rÃ¡pido
                        boton.textContent = "âœ… Agregado";
                        boton.disabled = true;
    
                        // Reactiva el botÃ³n despuÃ©s de 2 segundos
                        setTimeout(() => {
                            boton.textContent = "AÃ±adir al carrito ðŸ›’";
                            boton.disabled = false;
                        }, 2000);
                    }
                } catch (error) {
                    console.error("Error al agregar al carrito:", error);
                }
            });
        });
    });






    </script>
    


{% endblock %}
