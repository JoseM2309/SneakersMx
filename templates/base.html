<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SneakersMX</title>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <!-- CSS -->
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='img/logo.ico') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<body class="bg-white text-gray-900 font-sans transition-all duration-300">

<!-- NAVBAR PRINCIPAL -->
<header class="navbar flex justify-between items-center px-6 py-4 bg-white shadow-md">

    <!-- LOGO -->
    <a href="{{ url_for('index') }}" class="logo flex items-center text-2xl font-bold">
        ðŸ‘Ÿ <span class="ml-2">SneakersMX</span>
    </a>

    <!-- MENÃš ESCRITORIO -->
    <nav class="nav-links hidden md:flex gap-8 text-lg">
        <a href="{{ url_for('index') }}" class="hover:text-orange-500 transition">Inicio</a>
        <a href="{{ url_for('productos') }}" class="hover:text-orange-500 transition">Productos</a>
        <a href="{{ url_for('conocenos') }}" class="hover:text-orange-500 transition">ConÃ³cenos</a>
        <a href="{{ url_for('contacto') }}" class="hover:text-orange-500 transition">Contacto</a>
    </nav>

    <div class="flex items-center gap-6">
        {% if current_user.is_authenticated %}
            <a href="{{ url_for('logout') }}" class="text-xl text-green-600 font-bold">{{ current_user.nombre }} âœ–</a>
        {% else %}
            <div id="btnUsuario" class="cursor-pointer text-2xl"><i class="fas fa-user"></i></div>
        {% endif %}

        <a href="{{ url_for('carrito') }}" class="text-2xl hover:text-orange-500 transition">ðŸ›’</a>

        <!-- MenÃº mÃ³vil -->
        <div class="menu-toggle md:hidden cursor-pointer" id="menu-toggle">
            <span class="block w-8 h-1 bg-black mb-1"></span>
            <span class="block w-8 h-1 bg-black mb-1"></span>
            <span class="block w-8 h-1 bg-black"></span>
        </div>
    </div>
</header>

<!-- MENÃš MÃ“VIL -->
<nav class="nav-links-mobile hidden flex-col bg-white shadow-lg p-6 text-lg md:hidden">
    <a href="{{ url_for('index') }}" class="py-2 border-b">Inicio</a>
    <a href="{{ url_for('productos') }}" class="py-2 border-b">Productos</a>
    <a href="{{ url_for('conocenos') }}" class="py-2 border-b">ConÃ³cenos</a>
    <a href="{{ url_for('contacto') }}" class="py-2">Contacto</a>
</nav>

<!-- CONTENIDO -->
<main>{% block content %}{% endblock %}</main>

<!-- FOOTER -->
<footer class="text-center py-6 bg-gray-100 mt-8">
    <p>&copy; 2025 SneakersMX. Todos los derechos reservados.</p>
</footer>

<!-- PANEL DE ACCESIBILIDAD -->
<div id="accesibilidad-toggle">â™¿</div>
<div id="accesibilidad-options">
    <h3>Accesibilidad</h3>
    <button onclick="toggleNightMode()">Modo nocturno</button>
    <button onclick="toggleContrast()">Alto contraste</button>
    <button onclick="toggleGrayscale()">Escala de grises</button>
    <hr>
    <button onclick="increaseText()">Aumentar texto</button>
    <button onclick="decreaseText()">Disminuir texto</button>
    <button onclick="changeFont()">Cambiar tipografÃ­a</button>
    <hr>
    <button onclick="increaseCursor()">Cursor grande</button>
    <button onclick="togglePointer()">Puntero lector</button>
    <hr>
    <button onclick="document.getElementById('accesibilidad-options').classList.remove('show')">Cerrar âœ–</button>
</div>

<!-- MODAL LOGIN -->
<div id="modalLogin" class="fixed inset-0 bg-black/50 flex items-center justify-center hidden z-50">
    <div class="bg-white rounded-xl p-6 relative w-80">
        <span class="cerrar-modal absolute top-2 right-3 cursor-pointer text-lg">&times;</span>
        <h2 class="text-xl font-bold mb-4">Iniciar SesiÃ³n</h2>
        <form method="POST" action="{{ url_for('login') }}" class="flex flex-col gap-3">
            <input type="email" name="email" placeholder="Correo electrÃ³nico" required class="border p-2 rounded">
            <input type="password" name="password" placeholder="ContraseÃ±a" required class="border p-2 rounded">
            <button type="submit" class="bg-orange-500 text-white py-2 rounded hover:bg-orange-600 transition">Entrar</button>
        </form>
        <p class="mt-3 text-sm">Â¿No tienes cuenta? <a href="{{ url_for('registro') }}" class="text-orange-500">Crear cuenta</a></p>
    </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
    const btnUsuario = document.getElementById("btnUsuario");
    const modalLogin = document.getElementById("modalLogin");
    const cerrarModal = modalLogin.querySelector(".cerrar-modal");

    btnUsuario?.addEventListener("click", () => modalLogin.classList.remove("hidden"));
    cerrarModal?.addEventListener("click", () => modalLogin.classList.add("hidden"));
    modalLogin.addEventListener("click", (e) => { if(e.target === modalLogin) modalLogin.classList.add("hidden"); });
});
</script>

<!-- BURBUJA CHAT BOT -->
<div id="chat-bubble" class="fixed bottom-20 right-6 w-16 h-16 bg-gradient-to-br from-orange-500 to-red-500 rounded-full shadow-2xl flex items-center justify-center text-white text-3xl cursor-pointer z-50 transition-transform hover:scale-110">ðŸ’¬</div>

<!-- PANEL DE CHAT -->
<div id="chatbox" class="fixed bottom-20 right-6 w-80 bg-white border border-gray-300 rounded-2xl shadow-2xl z-50 hidden flex-col overflow-hidden transform scale-0 transition-transform duration-300">
    <div class="bg-gradient-to-r from-orange-500 to-red-500 text-white p-3 flex justify-between items-center">
        <span>Soporte SneakersMX</span>
        <button id="close-chat" class="text-white text-lg font-bold">âœ–</button>
    </div>
    <div id="messages" class="flex-1 p-3 overflow-y-auto space-y-2 bg-gray-50"></div>
    <!-- Input para escribir mensaje -->
    <div class="p-3 border-t border-gray-200 bg-white flex gap-2">
        <input id="chat-input" type="text" placeholder="Escribe tu mensaje..." class="flex-1 border p-2 rounded">
        <button onclick="sendInput()" class="bg-orange-500 text-white px-3 py-1 rounded hover:bg-orange-600 transition">Enviar</button>
    </div>
</div>

<script>
// MENÃš MÃ“VIL
document.getElementById("menu-toggle")?.addEventListener("click", () => {
    document.querySelector(".nav-links-mobile").classList.toggle("active");
});

// ACCESIBILIDAD
document.addEventListener("DOMContentLoaded", () => {
    const toggleBtn = document.getElementById('accesibilidad-toggle');
    const options = document.getElementById('accesibilidad-options');

    toggleBtn.addEventListener('click', () => options.classList.toggle('show'));

    window.toggleNightMode = () => {
        document.body.classList.toggle('night-mode');
        options.style.background = "#fff";
        toggleBtn.style.background = "#fff";
        toggleBtn.style.color = "#000";
    };
    window.toggleGrayscale = () => document.body.classList.toggle('grayscale');
    window.toggleContrast = () => document.body.classList.toggle('high-contrast');

    window.increaseText = () => {
        let size = parseFloat(getComputedStyle(document.body).fontSize);
        document.body.style.fontSize = (size + 2) + 'px';
    };
    window.decreaseText = () => {
        let size = parseFloat(getComputedStyle(document.body).fontSize);
        document.body.style.fontSize = (size - 2) + 'px';
    };

    window.changeFont = () => {
        const currentFont = document.body.dataset.font || "normal";
        if (currentFont === "normal") {
            document.body.style.fontFamily = 'Courier New, monospace';
            document.body.dataset.font = "mono";
        } else if (currentFont === "mono") {
            document.body.style.fontFamily = 'Arial, sans-serif';
            document.body.dataset.font = "sans";
        } else {
            document.body.style.fontFamily = '';
            document.body.dataset.font = "normal";
        }
    };

    window.increaseCursor = () => document.body.classList.toggle('large-cursor');
    window.togglePointer = () => document.body.classList.toggle('pointer-reader');
});

// CHAT BOT
const chatBubble = document.getElementById("chat-bubble");
const chatbox = document.getElementById("chatbox");
const closeBtn = document.getElementById("close-chat");

chatBubble.addEventListener("click", () => {
    chatbox.classList.toggle("hidden");
    setTimeout(() => chatbox.classList.toggle("scale-0"), 10);
});
closeBtn.addEventListener("click", () => {
    chatbox.classList.add("scale-0");
    setTimeout(() => chatbox.classList.add("hidden"), 300);
});

async function sendOption(option) {
    const messagesDiv = document.getElementById("messages");
    messagesDiv.innerHTML += `<div class="text-right"><span class="inline-block bg-orange-100 text-orange-800 px-3 py-1 rounded-lg">${option}</span></div>`;

    const res = await fetch("/api/chatbot", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({option})
    });
    const data = await res.json();
    messagesDiv.innerHTML += `<div class="text-left"><span class="inline-block bg-orange-500 text-white px-3 py-1 rounded-lg">${data.reply}</span></div>`;
    messagesDiv.scrollTop = messagesDiv.scrollHeight;
}

// Enviar mensaje desde input
function sendInput() {
    const input = document.getElementById("chat-input");
    const text = input.value.trim();
    if(text !== "") {
        sendOption(text);
        input.value = "";
    }
}
</script>

</body>
</html>



